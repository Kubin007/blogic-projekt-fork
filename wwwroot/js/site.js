const data = {
  moje: [
    { title: "Rohlík", price: "2 Kč", img: "/image/rohlik.png" },
    { title: "Monster Lewis", price: "30 Kč", img: "/image/monster.png" },
    { title: "Adam", price: "69 Kč", img: "/image/adam.png" },
    { title: "Moje 4", price: "130 Kč", img: "https://via.placeholder.com/300" },
    { title: "Moje 5", price: "100 Kč", img: "https://via.placeholder.com/300" },
    { title: "Moje 6", price: "110 Kč", img: "https://via.placeholder.com/300" },
    { title: "Moje 7", price: "120 Kč", img: "https://via.placeholder.com/300" },
    { title: "Moje 8", price: "130 Kč", img: "https://via.placeholder.com/300" },
  ],
  ostatni: [
    { title: "Fidorka", price: "15 Kč", img: "/image/fidorka.png" },
    { title: "Ostatní 2", price: "95 Kč", img: "https://via.placeholder.com/300" },
    { title: "Ostatní 3", price: "99 Kč", img: "https://via.placeholder.com/300" },
    { title: "Ostatní 4", price: "105 Kč", img: "https://via.placeholder.com/300" },
    { title: "Ostatní 5", price: "90 Kč", img: "https://via.placeholder.com/300" },
    { title: "Ostatní 6", price: "95 Kč", img: "https://via.placeholder.com/300" },
    { title: "Ostatní 7", price: "99 Kč", img: "https://via.placeholder.com/300" },
    { title: "Ostatní 8", price: "105 Kč", img: "https://via.placeholder.com/300" },
  ],
  sleva: [
    { title: "WC", price: "5 Kč", img: "image/kadibudka.png" },
    { title: "Sleva 2", price: "75 Kč", img: "https://via.placeholder.com/300" },
    { title: "Sleva 3", price: "80 Kč", img: "https://via.placeholder.com/300" },
    { title: "Sleva 4", price: "85 Kč", img: "https://via.placeholder.com/300" },
     { title: "Sleva 5", price: "70 Kč", img: "https://via.placeholder.com/300" },
    { title: "Sleva 6", price: "75 Kč", img: "https://via.placeholder.com/300" },
    { title: "Sleva 7", price: "80 Kč", img: "https://via.placeholder.com/300" },
    { title: "Sleva 8", price: "85 Kč", img: "https://via.placeholder.com/300" },
  ],
  novinka: [
    { title: "Muller milk", price: "30 Kč", img: "/image/dubai.jpg" },
    { title: "Novinka 2", price: "160 Kč", img: "https://via.placeholder.com/300" },
    { title: "Novinka 3", price: "170 Kč", img: "https://via.placeholder.com/300" },
    { title: "Novinka 4", price: "180 Kč", img: "https://via.placeholder.com/300" },
     { title: "Novinka 5", price: "150 Kč", img: "https://via.placeholder.com/300" },
    { title: "Novinka 6", price: "160 Kč", img: "https://via.placeholder.com/300" },
    { title: "Novinka 7", price: "170 Kč", img: "https://via.placeholder.com/300" },
    { title: "Novinka 8", price: "180 Kč", img: "https://via.placeholder.com/300" },
  ],
  svacina: [
    { title: "Toast", price: "30 Kč", img: "/image/toast.jpg" },
    { title: "Svačina 2", price: "60 Kč", img: "https://via.placeholder.com/300" },
    { title: "Svačina 3", price: "62 Kč", img: "https://via.placeholder.com/300" },
    { title: "Svačina 4", price: "64 Kč", img: "https://via.placeholder.com/300" },
     { title: "Svačina 5", price: "55 Kč", img: "https://via.placeholder.com/300" },
    { title: "Svačina 6", price: "60 Kč", img: "https://via.placeholder.com/300" },
    { title: "Svačina 7", price: "62 Kč", img: "https://via.placeholder.com/300" },
    { title: "Svačina 8", price: "64 Kč", img: "https://via.placeholder.com/300" },
  ],
  sladke: [
    { title: "Kinder Bueno", price: "20 Kč", img: "/image/bueno.jpeg" },
    { title: "Sladké 2", price: "40 Kč", img: "https://via.placeholder.com/300" },
    { title: "Sladké 3", price: "45 Kč", img: "https://via.placeholder.ccom/300" },
    { title: "Sladké 4", price: "50 Kč", img: "https://via.placeholder.com/300" },
    { title: "Sladké 5", price: "35 Kč", img: "https://via.placeholder.com/300" },
    { title: "Sladké 6", price: "40 Kč", img: "https://via.placeholder.com/300" },
    { title: "Sladké 7", price: "45 Kč", img: "https://via.placeholder.ccom/300" },
    { title: "Sladké 8", price: "50 Kč", img: "https://via.placeholder.com/300" },
  ],
  slane: [
    { title: "Bohemia Chips solené", price: "30 Kč", img: "/image/bohemia.png" },
    { title: "Slané 2", price: "30 Kč", img: "https://via.placeholder.com/300" },
    { title: "Slané 3", price: "33 Kč", img: "https://via.placeholder.com/300" },
    { title: "Slané 4", price: "36 Kč", img: "https://via.placeholder.com/300" },
     { title: "Slané 5", price: "25 Kč", img: "https://via.placeholder.com/300" },
    { title: "Slané 6", price: "30 Kč", img: "https://via.placeholder.com/300" },
    { title: "Slané 7", price: "33 Kč", img: "https://via.placeholder.com/300" },
    { title: "Slané 8", price: "36 Kč", img: "https://via.placeholder.com/300" },
  ],
  napoje: [
    { title: "Pepsi", price: "20 Kč", img: "/image/pepsi.png" },
    { title: "Nápoj 2", price: "25 Kč", img: "https://via.placeholder.com/300" },
    { title: "Nápoj 3", price: "28 Kč", img: "https://via.placeholder.com/300" },
    { title: "Nápoj 4", price: "30 Kč", img: "https://via.placeholder.com/300" },
      { title: "Nápoj 5", price: "20 Kč", img: "https://via.placeholder.com/300" },
    { title: "Nápoj 6", price: "25 Kč", img: "https://via.placeholder.com/300" },
    { title: "Nápoj 7", price: "28 Kč", img: "https://via.placeholder.com/300" },
    { title: "Nápoj 8", price: "30 Kč", img: "https://via.placeholder.com/300" },
  ],
  zmrzlina: [
    { title: "Mrož", price: "18 Kč", img: "/image/mroz.png" },
    { title: "Zmrzlina 2", price: "65 Kč", img: "https://via.placeholder.com/300" },
    { title: "Zmrzlina 3", price: "68 Kč", img: "https://via.placeholder.com/300" },
    { title: "Zmrzlina 4", price: "72 Kč", img: "https://via.placeholder.com/300" },
     { title: "Zmrzlina 5", price: "60 Kč", img: "https://via.placeholder.com/300" },
    { title: "Zmrzlina 6", price: "65 Kč", img: "https://via.placeholder.com/300" },
    { title: "Zmrzlina 7", price: "68 Kč", img: "https://via.placeholder.com/300" },
    { title: "Zmrzlina 8", price: "72 Kč", img: "https://via.placeholder.com/300" },
  ]
};
function loadCategory(category) {
  const productsDiv = document.getElementById("products");
  productsDiv.innerHTML = "";

  if (!data[category]) {
    productsDiv.innerHTML = "<p>Žádné produkty k zobrazení.</p>";
    return;
  }

  data[category].forEach(product => {
    const col = document.createElement("div");
    col.className = "col-md-3 mb-4";
    col.innerHTML = `
      <div class="card h-100">
        <img src="${product.img}" class="card-img-top product-img" alt="${product.title}">
        <div class="card-body">
          <h5 class="card-title">${product.title}</h5>
          <p class="card-text">${product.price}</p>
          <a  class="btn btn-warning" onclick="addToCart('${product.title}', '${product.price}', '${product.img}')">Koupit</a>
        </div>
      </div>
    `;
    productsDiv.appendChild(col);
  });
}

function addToCart(title, price, img) {
  let cart = JSON.parse(localStorage.getItem("cart")) || [];
  const index = cart.findIndex(p => p.title === title);
  if (index > -1) {
    cart[index].quantity = (cart[index].quantity || 1) + 1;
  } else {
    cart.push({ title, price, img, quantity: 1 });
  }
  localStorage.setItem("cart", JSON.stringify(cart));
  alert(`✅ Přidáno do košíku: ${title}`);
  updateCartCount();
}

function updateCartCount() {
  const cart = JSON.parse(localStorage.getItem("cart")) || [];
  const totalCount = cart.reduce((sum, item) => sum + (item.quantity || 1), 0);
  const countEl = document.getElementById("cart-count");
  if (countEl) countEl.textContent = totalCount;
}

function renderCart() {
  const cart = JSON.parse(localStorage.getItem("cart")) || [];
  const tableBody = document.getElementById("cart-table-body");
  const totalEl = document.getElementById("total-price");
  if (!tableBody || !totalEl) return;

  tableBody.innerHTML = "";
  let total = 0;

  cart.forEach((item, index) => {
    item.quantity = item.quantity || 1; // Ochrana pro starší záznamy
    const priceNumber = parseInt(item.price.replace(" Kč", ""));
    const itemTotal = item.quantity * priceNumber;
    total += itemTotal;

    const row = document.createElement("tr");
    row.innerHTML = `
      <td class="td">
        <div class="produkt">
          ${item.title}
          <img src="${item.img}">
        </div>
      </td>
      <td class="td text-center">${item.quantity} ks.</td>
      <td class="td text-center">${itemTotal} Kč</td>
      <td class="td text-center">
        <a class="delete-button" onclick="removeFromCart(${index})" style="text-decoration: none;">
          <img class="icon" src="/images/delete_forever.png">
        </a>
      </td>
    `;
    tableBody.appendChild(row);
  });

  totalEl.textContent = `${total} Kč`;
}

function removeFromCart(index) {
  const cart = JSON.parse(localStorage.getItem("cart")) || [];
  cart[index].quantity = cart[index].quantity || 1;

  if (cart[index].quantity > 1) {
    cart[index].quantity -= 1;
  } else {
    cart.splice(index, 1);
  }

  localStorage.setItem("cart", JSON.stringify(cart));
  renderCart();
  updateCartCount();
}

function clearCart() {
  if (confirm("Opravdu chcete vysypat celý košík?")) {
    localStorage.removeItem("cart");
    renderCart();
    updateCartCount();
  }
}

window.onload = () => {
  loadCategory('moje');
  updateCartCount();
  renderCart();
};