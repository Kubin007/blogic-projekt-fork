const data = {
  moje: [
    { title: "Moje 1", price: "100 Kč", img: "/image/rohlik.png" },
    { title: "Moje 2", price: "110 Kč", img: "/image/monster.png" },
    { title: "Moje 3", price: "120 Kč", img: "/image/adam.png" },
    { title: "Moje 4", price: "130 Kč", img: "https://via.placeholder.com/300" },
    { title: "Moje 5", price: "100 Kč", img: "https://via.placeholder.com/300" },
    { title: "Moje 6", price: "110 Kč", img: "https://via.placeholder.com/300" },
    { title: "Moje 7", price: "120 Kč", img: "https://via.placeholder.com/300" },
    { title: "Moje 8", price: "130 Kč", img: "https://via.placeholder.com/300" },
  ],
  ostatni: [
    { title: "Ostatní 1", price: "90 Kč", img: "https://via.placeholder.com/300" },
    { title: "Ostatní 2", price: "95 Kč", img: "https://via.placeholder.com/300" },
    { title: "Ostatní 3", price: "99 Kč", img: "https://via.placeholder.com/300" },
    { title: "Ostatní 4", price: "105 Kč", img: "https://via.placeholder.com/300" },
    { title: "Ostatní 5", price: "90 Kč", img: "https://via.placeholder.com/300" },
    { title: "Ostatní 6", price: "95 Kč", img: "https://via.placeholder.com/300" },
    { title: "Ostatní 7", price: "99 Kč", img: "https://via.placeholder.com/300" },
    { title: "Ostatní 8", price: "105 Kč", img: "https://via.placeholder.com/300" },
  ],
  sleva: [
    { title: "Sleva 1", price: "70 Kč", img: "https://via.placeholder.com/300" },
    { title: "Sleva 2", price: "75 Kč", img: "https://via.placeholder.com/300" },
    { title: "Sleva 3", price: "80 Kč", img: "https://via.placeholder.com/300" },
    { title: "Sleva 4", price: "85 Kč", img: "https://via.placeholder.com/300" },
     { title: "Sleva 5", price: "70 Kč", img: "https://via.placeholder.com/300" },
    { title: "Sleva 6", price: "75 Kč", img: "https://via.placeholder.com/300" },
    { title: "Sleva 7", price: "80 Kč", img: "https://via.placeholder.com/300" },
    { title: "Sleva 8", price: "85 Kč", img: "https://via.placeholder.com/300" },
  ],
  novinka: [
    { title: "Novinka 1", price: "150 Kč", img: "https://via.placeholder.com/300" },
    { title: "Novinka 2", price: "160 Kč", img: "https://via.placeholder.com/300" },
    { title: "Novinka 3", price: "170 Kč", img: "https://via.placeholder.com/300" },
    { title: "Novinka 4", price: "180 Kč", img: "https://via.placeholder.com/300" },
     { title: "Novinka 5", price: "150 Kč", img: "https://via.placeholder.com/300" },
    { title: "Novinka 6", price: "160 Kč", img: "https://via.placeholder.com/300" },
    { title: "Novinka 7", price: "170 Kč", img: "https://via.placeholder.com/300" },
    { title: "Novinka 8", price: "180 Kč", img: "https://via.placeholder.com/300" },
  ],
  svacina: [
    { title: "Svačina 1", price: "55 Kč", img: "https://via.placeholder.com/300" },
    { title: "Svačina 2", price: "60 Kč", img: "https://via.placeholder.com/300" },
    { title: "Svačina 3", price: "62 Kč", img: "https://via.placeholder.com/300" },
    { title: "Svačina 4", price: "64 Kč", img: "https://via.placeholder.com/300" },
     { title: "Svačina 5", price: "55 Kč", img: "https://via.placeholder.com/300" },
    { title: "Svačina 6", price: "60 Kč", img: "https://via.placeholder.com/300" },
    { title: "Svačina 7", price: "62 Kč", img: "https://via.placeholder.com/300" },
    { title: "Svačina 8", price: "64 Kč", img: "https://via.placeholder.com/300" },
  ],
  sladke: [
    { title: "Sladké 1", price: "35 Kč", img: "https://via.placeholder.com/300" },
    { title: "Sladké 2", price: "40 Kč", img: "https://via.placeholder.com/300" },
    { title: "Sladké 3", price: "45 Kč", img: "https://via.placeholder.ccom/300" },
    { title: "Sladké 4", price: "50 Kč", img: "https://via.placeholder.com/300" },
    { title: "Sladké 5", price: "35 Kč", img: "https://via.placeholder.com/300" },
    { title: "Sladké 6", price: "40 Kč", img: "https://via.placeholder.com/300" },
    { title: "Sladké 7", price: "45 Kč", img: "https://via.placeholder.ccom/300" },
    { title: "Sladké 8", price: "50 Kč", img: "https://via.placeholder.com/300" },
  ],
  slane: [
    { title: "Slané 1", price: "25 Kč", img: "https://via.placeholder.com/300" },
    { title: "Slané 2", price: "30 Kč", img: "https://via.placeholder.com/300" },
    { title: "Slané 3", price: "33 Kč", img: "https://via.placeholder.com/300" },
    { title: "Slané 4", price: "36 Kč", img: "https://via.placeholder.com/300" },
     { title: "Slané 5", price: "25 Kč", img: "https://via.placeholder.com/300" },
    { title: "Slané 6", price: "30 Kč", img: "https://via.placeholder.com/300" },
    { title: "Slané 7", price: "33 Kč", img: "https://via.placeholder.com/300" },
    { title: "Slané 8", price: "36 Kč", img: "https://via.placeholder.com/300" },
  ],
  napoje: [
    { title: "Nápoj 1", price: "20 Kč", img: "https://via.placeholder.com/300" },
    { title: "Nápoj 2", price: "25 Kč", img: "https://via.placeholder.com/300" },
    { title: "Nápoj 3", price: "28 Kč", img: "https://via.placeholder.com/300" },
    { title: "Nápoj 4", price: "30 Kč", img: "https://via.placeholder.com/300" },
      { title: "Nápoj 5", price: "20 Kč", img: "https://via.placeholder.com/300" },
    { title: "Nápoj 6", price: "25 Kč", img: "https://via.placeholder.com/300" },
    { title: "Nápoj 7", price: "28 Kč", img: "https://via.placeholder.com/300" },
    { title: "Nápoj 8", price: "30 Kč", img: "https://via.placeholder.com/300" },
  ],
  zmrzlina: [
    { title: "Zmrzlina 1", price: "60 Kč", img: "https://via.placeholder.com/300" },
    { title: "Zmrzlina 2", price: "65 Kč", img: "https://via.placeholder.com/300" },
    { title: "Zmrzlina 3", price: "68 Kč", img: "https://via.placeholder.com/300" },
    { title: "Zmrzlina 4", price: "72 Kč", img: "https://via.placeholder.com/300" },
     { title: "Zmrzlina 5", price: "60 Kč", img: "https://via.placeholder.com/300" },
    { title: "Zmrzlina 6", price: "65 Kč", img: "https://via.placeholder.com/300" },
    { title: "Zmrzlina 7", price: "68 Kč", img: "https://via.placeholder.com/300" },
    { title: "Zmrzlina 8", price: "72 Kč", img: "https://via.placeholder.com/300" },
  ]
};

function loadCategory(category) {
  const productsDiv = document.getElementById("products");
  productsDiv.innerHTML = "";

  if (!data[category]) {
    productsDiv.innerHTML = "<p>Žádné produkty k zobrazení.</p>";
    return;
  }

  data[category].forEach(product => {
    const col = document.createElement("div");
    col.className = "col-md-3 mb-4";
    col.innerHTML = `
      <div class="card h-100">
        <img src="${product.img}" class="card-img-top product-img" alt="${product.title}">
        <div class="card-body">
          <h5 class="card-title">${product.title}</h5>
          <p class="card-text">${product.price}</p>
          <a href="#" class="btn btn-warning" onclick="addToCart('${product.title}', '${product.price}', '${product.img}')">Koupit</a>
        </div>
      </div>
    `;
    productsDiv.appendChild(col);
  });
}

function addToCart(title, price, img) {
  const cart = JSON.parse(localStorage.getItem("cart")) || [];
  cart.push({ title, price, img });
  localStorage.setItem("cart", JSON.stringify(cart));
  alert(`✅ Přidáno do košíku: ${title}`);
  updateCartCount?.();
}

function updateCartCount() {
  const cart = JSON.parse(localStorage.getItem("cart")) || [];
  const countEl = document.getElementById("cart-count");
  if (countEl) countEl.textContent = cart.length;
}

function renderCart() {
  const cart = JSON.parse(localStorage.getItem("cart")) || [];
  const tableBody = document.getElementById("cart-table-body");
  const totalEl = document.getElementById("total-price");
  if (!tableBody || !totalEl) return;

  tableBody.innerHTML = "";
  let total = 0;

  cart.forEach((item, index) => {
    const priceNumber = parseInt(item.price.replace(" Kč", ""));
    total += priceNumber;

    const row = document.createElement("tr");
    row.innerHTML = `
      <td class="td">
        <div class="produkt">
          ${item.title}
          <img src="${item.img}" style="max-width: 70px;">
        </div>
      </td>
      <td class="td" style="text-align: center;">1 ks.</td>
      <td class="td" style="text-align: center;">${item.price}</td>
      <td class="td" style="text-align: center;">
        <a class="delete-button" href="#" onclick="removeFromCart(${index})" style="text-decoration: none;">
          <img class="icon" src="/images/delete_forever.png" style="width:24px;">
        </a>
      </td>
    `;
    tableBody.appendChild(row);
  });

  totalEl.textContent = `${total} Kč`;
}

function removeFromCart(index) {
  const cart = JSON.parse(localStorage.getItem("cart")) || [];
  cart.splice(index, 1);
  localStorage.setItem("cart", JSON.stringify(cart));
  renderCart();
  updateCartCount();
}

function clearCart() {
  if (confirm("Opravdu chcete vysypat celý košík?")) {
    localStorage.removeItem("cart");
    renderCart();
    updateCartCount();
  }
}

// Při načtení stránky
window.onload = () => {
  loadCategory('moje');
  updateCartCount();
  renderCart();
};
